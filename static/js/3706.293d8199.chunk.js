"use strict";(self.webpackChunkesri_map=self.webpackChunkesri_map||[]).push([[3706],{83706:function(e,t,r){r.d(t,{Z:function(){return ae}});var n=r(1413),i=r(37762),a=r(15861),s=r(43144),u=r(15671),o=r(87757),c=r(10064),l=r(84652),f=r(92026),h=r(18759),p=r(68860),d=r(41414),y=r(65156),m=r(376),v=r(77981),x=r(50689),g=r(92975),b=r(93433),S=r(59026),_=r(48562),k=function(){function e(t,r){(0,u.Z)(this,e),this._cache=new S.Z(t),this._invalidCache=new S.Z(r)}return(0,s.Z)(e,[{key:"get",value:function(e,t){var r="".concat(t.uid,":").concat(e),n=this._cache.get(r);if(n)return n;if(void 0!==this._invalidCache.get(r))return null;try{var i=_.WhereClause.create(e,t);return this._cache.put(r,i),i}catch(a){return this._invalidCache.put(r,null),null}}}]),e}(),w=new k(50,500),F="feature-store:unsupported-query",I=" as ",R=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function Z(e,t){if(!t)return!0;var r=w.get(t,e);if(!r)throw new c.Z(F,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new c.Z(F,"where clause is not standard",{where:t});return E(e,r.fieldNames,"where clause contains missing fields"),!0}function T(e,t,r){if(!t)return!0;var n=w.get(t,e);if(!n)throw new c.Z(F,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new c.Z(F,"having does not contain a valid aggregate function",{having:t});var i=n.fieldNames;if(E(e,i,"having contains missing fields"),!n.getExpressions().every((function(t){var n=t.aggregateType,i=t.field,a=e.has(i)&&e.get(i).name;return r.some((function(t){var r=t.onStatisticField,i=t.statisticType;return(e.has(r)&&e.get(r).name)===a&&i.toLowerCase().trim()===n}))})))throw new c.Z(F,"expressions in having should also exist in outStatistics",{having:t});return!0}function A(e,t){return e?w.get(e,t):null}function E(e,t,r){var n,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=[],u=(0,i.Z)(t);try{for(u.s();!(n=u.n()).done;){var o=n.value;if("*"!==o&&!e.has(o))if(a){var l=Q(o);try{var f=A(l,e);if(!f)throw new c.Z(F,"invalid SQL expression",{where:l});if(!f.isStandardized)throw new c.Z(F,"expression is not standard",{clause:f});E(e,f.fieldNames,"expression contains missing fields")}catch(p){var h=p&&p.details;if(h&&(h.clause||h.where))throw p;h&&h.missingFields?s.push.apply(s,(0,b.Z)(h.missingFields)):s.push(o)}}else s.push(o)}}catch(d){u.e(d)}finally{u.f()}if(s.length)throw new c.Z(F,r,{missingFields:s})}function Q(e){return e.split(I)[0]}function C(e){return e.split(I)[1]}function V(e,t){var r=t.get(e);return!!r&&!R.has(r.type)}var z,G,P=r(19995),N=r(60480),M=r(4954),O=r(94446),D=r(58971),q=r(83406),j=r(15903),B=function(){function e(t,r,n){(0,u.Z)(this,e),this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=n,this.featureAdapter=r;var a=t.outFields;if(a&&-1===a.indexOf("*")){this.outFields=a;var s,o=0,c=(0,i.Z)(a);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=Q(l),h=this.fieldsIndex.get(f),p=h?null:A(f,n),d=h?h.name:C(l)||"FIELD_EXP_"+o++;this._fieldDataCache.set(l,{alias:d,clause:p})}}catch(y){c.e(y)}finally{c.f()}}}return(0,s.Z)(e,[{key:"countDistinctValues",value:function(e){var t=this;return this.returnDistinctValues?(e.forEach((function(e){return t.getAttributes(e)})),this._returnDistinctMap.size):e.length}},{key:"getAttributes",value:function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}},{key:"getFieldValue",value:function(e,t,r){var n=r?r.name:t,i=null;return this._fieldDataCache.has(n)?i=this._fieldDataCache.get(n).clause:r||(i=A(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:i})),r?this.featureAdapter.getAttribute(e,n):i.calculateValue(e,this.featureAdapter)}},{key:"getNormalizedValue",value:function(e,t){var r=t.normalizationType,n=t.normalizationTotal,i=this.getFieldValue(e,t.field,t.fieldInfo);if(r&&Number.isFinite(i)){var a=this.getFieldValue(e,t.normalizationField,t.normalizationFieldInfo);i=(0,j.fk)(i,r,a,n)}return i}},{key:"getExpressionValue",value:function(e,t,r){var n={attributes:this.featureAdapter.getAttributes(e)},i=r.createExecContext(n,t.viewInfo);return r.executeFunction(t.compiledFunc,i)}},{key:"validateItem",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:A(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}},{key:"validateItems",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:A(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}},{key:"_processAttributesForOutFields",value:function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);var r,n={},a=(0,i.Z)(t);try{for(a.s();!(r=a.n()).done;){var s=r.value,u=this._fieldDataCache.get(s),o=u.alias,c=u.clause;n[o]=c?c.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,o)}}catch(l){a.e(l)}finally{a.f()}return n}},{key:"_processAttributesForDistinctValues",value:function(e){if((0,f.Wi)(e)||!this.returnDistinctValues)return e;var t=this.outFields,r=[];if(t){var n,a=(0,i.Z)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value,u=this._fieldDataCache.get(s).alias;r.push(e[u])}}catch(h){a.e(h)}finally{a.f()}}else for(var o in e)r.push(e[o]);var c="".concat((t||["*"]).join(","),"=").concat(r.join(",")),l=this._returnDistinctMap.get(c)||0;return this._returnDistinctMap.set(c,++l),l>1?null:e}}]),e}(),U=r(20311),W=r(31904),Y=r(80031),L=r(819),H=function(){function e(t,r,n){(0,u.Z)(this,e),this.items=t,this.queryGeometry=r,this.definitionExpression=n.definitionExpression,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.fieldsIndex=n.fieldsIndex,this.timeInfo=n.timeInfo,this.featureAdapter=n.featureAdapter,this.aggregateAdapter=n.aggregateAdapter}return(0,s.Z)(e,[{key:"size",get:function(){return this.items.length}},{key:"createQueryResponseForCount",value:function(e){var t=new B(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);var r=e.groupByFieldsForStatistics,n=e.having;if(!(null==r?void 0:r.length))return 1;var a,s=new Map,u=new Map,o=new Set,c=e.outStatistics,l=(0,i.Z)(c);try{for(l.s();!(a=l.n()).done;){var f=a.value,h="exceedslimit"!==f.statisticType?f.onStatisticField:void 0;if(!u.has(h)){var p,d=[],y=(0,i.Z)(r);try{for(y.s();!(p=y.n()).done;){var m=p.value,v=this._getAttributeValues(t,m,s);d.push(v)}}catch(w){y.e(w)}finally{y.f()}u.set(h,this._calculateUniqueValues(d,t.returnDistinctValues))}var x=u.get(h);for(var g in x){var b=x[g],S=b.data,_=b.items,k=S.join(",");n&&!t.validateItems(_,n)||o.add(k)}}}catch(w){l.e(w)}finally{l.f()}return o.size}},{key:"createQueryResponse",value:function(){var e=(0,a.Z)(o.mark((function e(t){var r;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.outStatistics){e.next=11;break}if(!t.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))){e.next=5;break}e.t0=this._createExceedsLimitQueryResponse(t),e.next=8;break;case 5:return e.next=7,this._createStatisticsQueryResponse(t);case 7:e.t0=e.sent;case 8:r=e.t0,e.next=12;break;case 11:r=this._createFeatureQueryResponse(t);case 12:return e.abrupt("return",(t.returnQueryGeometry&&((0,g.JY)(t.outSR)&&!(0,g.fS)(this.queryGeometry.spatialReference,t.outSR)?r.queryGeometry=(0,W.S2)((0,n.Z)({spatialReference:t.outSR},(0,P.iV)(this.queryGeometry,this.queryGeometry.spatialReference,t.outSR))):r.queryGeometry=(0,W.S2)((0,n.Z)({spatialReference:t.outSR},this.queryGeometry))),r));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createSnappingResponse",value:function(e,t){var r,n=this.featureAdapter,a=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),s=e.point,u=s.x,o=s.y,c="number"==typeof e.distance?e.distance:e.distance.x,l="number"==typeof e.distance?e.distance:e.distance.y,h={candidates:[]},p="esriGeometryPolygon"===this.geometryType,d=this._getPointCreator(e.point,this.spatialReference,t),y=(0,i.Z)(this.items);try{for(y.s();!(r=y.n()).done;){var m=r.value,v=n.getGeometry(m);if(!(0,f.Wi)(v)){var x=v.coords,g=v.lengths;if(e.types&z.EDGE)for(var b=0,S=0;S<g.length;S++)for(var _=g[S],k=0;k<_;k++,b+=a){var w=x[b],F=x[b+1];if(k!==_-1){var I=x[b+a],R=x[b+a+1],Z=X(u,o,w,F,I,R),T=Z.x,A=Z.y,E=(u-T)/c,Q=(o-A)/l,C=E*E+Q*Q;C<=1&&h.candidates.push({type:"edge",objectId:n.getObjectId(m),distance:Math.sqrt(C),target:d(T,A),start:d(w,F),end:d(I,R)})}}if(e.types&z.VERTEX)for(var V=p?x.length-a:x.length,G=0;G<V;G+=a){var P=x[G],N=x[G+1],M=(u-P)/c,O=(o-N)/l,D=M*M+O*O;D<=1&&h.candidates.push({type:"vertex",objectId:n.getObjectId(m),distance:Math.sqrt(D),target:d(P,N)})}}}}catch(q){y.e(q)}finally{y.f()}return h.candidates.sort((function(e,t){return e.distance-t.distance})),h}},{key:"_getPointCreator",value:function(e,t,r){var n=(0,f.pC)(r)&&!(0,g.fS)(t,r)?function(e){return(0,P.iV)(e,t,r)}:function(e){return e};return null!=e.z&&null!=e.m?function(t,r){return n({x:t,y:r,z:e.z,m:e.m})}:null!=e.z?function(t,r){return n({x:t,y:r,z:e.z})}:null!=e.m?function(t,r){return n({x:t,y:r,m:e.m})}:function(e,t){return n({x:e,y:t})}}},{key:"executeAttributesQuery",value:function(t){var r=A(t.where,this.fieldsIndex);if(!r)return Promise.resolve(this);if(r.isStandardized){var n,a=0,s=[],u=(0,i.Z)(this.items);try{for(u.s();!(n=u.n()).done;){var o=n.value;r.testFeature(o,this.featureAdapter)&&(s[a++]=o)}}catch(l){u.e(l)}finally{u.f()}var c=new e(s,this.queryGeometry,this);return c.definitionExpression=t.where,Promise.resolve(c)}return Promise.reject(new TypeError("Where clause is not standardized"))}},{key:"executeAggregateIdsQuery",value:function(t){if(!t.aggregateIds||!t.aggregateIds.length||(0,f.Wi)(this.aggregateAdapter))return Promise.resolve(this);var r,n=new Set,a=(0,i.Z)(t.aggregateIds);try{for(a.s();!(r=a.n()).done;){var s=r.value;this.aggregateAdapter.getFeatureObjectIds(s).forEach((function(e){return n.add(e)}))}}catch(o){a.e(o)}finally{a.f()}var u=this.featureAdapter.getObjectId;return Promise.resolve(new e(this.items.filter((function(e){return n.has(u(e))})),this.queryGeometry,this))}},{key:"executeObjectIdsQuery",value:function(t){if(!t.objectIds||!t.objectIds.length)return Promise.resolve(this);var r=new Set(t.objectIds),n=this.featureAdapter.getObjectId;return Promise.resolve(new e(this.items.filter((function(e){return r.has(n(e))})),this.queryGeometry,this))}},{key:"executeTimeQuery",value:function(t){var r=(0,U.y)(this.timeInfo,t.timeExtent,this.featureAdapter);if(!(0,f.pC)(r))return Promise.resolve(this);var n=this.items.filter(r);return Promise.resolve(new e(n,this.queryGeometry,this))}},{key:"filterLatest",value:function(){var t,r=this.timeInfo,n=r.trackIdField,a=r.startTimeField,s=r.endTimeField||a,u=new Map,o=this.featureAdapter.getAttribute,c=(0,i.Z)(this.items);try{for(c.s();!(t=c.n()).done;){var l=t.value,f=o(l,n),h=o(l,s),p=u.get(f);(!p||h>o(p,s))&&u.set(f,l)}}catch(y){c.e(y)}finally{c.f()}var d=Array.from(u.values());return Promise.resolve(new e(d,this.queryGeometry,this))}},{key:"project",value:function(){var t=(0,a.Z)(o.mark((function t(r){var n,i,a=this;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r&&!(0,g.fS)(this.spatialReference,r)){t.next=2;break}return t.abrupt("return",this);case 2:return n=this.featureAdapter,t.next=5,(0,P.oj)(this.items.map((function(e){return(0,W.Op)(a.geometryType,a.hasZ,a.hasM,n.getGeometry(e))})),this.spatialReference,r);case 5:return i=t.sent.map((function(e,t){return n.cloneWithGeometry(a.items[t],(0,q.GH)(e,a.hasZ,a.hasM))})),t.abrupt("return",new e(i,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:r,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter}));case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"createSummaryStatisticsResponse",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var n,i,a,s,u,c,l,f,h,p,d,y,m,v;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.field,i=r.valueExpression,a=r.normalizationField,s=r.normalizationType,u=r.normalizationTotal,c=r.minValue,l=r.maxValue,f=r.scale,h=this.fieldsIndex.isDateField(n),e.next=11,this._getDataValues(t,{field:n,valueExpression:i,normalizationField:a,normalizationType:s,normalizationTotal:u,scale:f});case 11:return p=e.sent,d=(0,j.S5)({normalizationType:s,normalizationField:a,minValue:c,maxValue:l}),y=this.fieldsIndex.get(n),m={value:.5,fieldType:null==y?void 0:y.type},v=(0,Y.qN)(y)?(0,j.H0)({values:p,supportsNullCount:d,percentileParams:m}):(0,j.i5)({values:p,minValue:c,maxValue:l,useSampleStdDev:!s,supportsNullCount:d,percentileParams:m}),e.abrupt("return",(0,j.F_)(v,h));case 17:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createUniqueValuesResponse",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var n,i,a,s,u,c,l;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.field,i=r.valueExpression,a=r.domain,s=r.returnAllCodedValues,u=r.scale,e.next=7,this._getDataValues(t,{field:n,valueExpression:i,scale:u});case 7:return c=e.sent,l=(0,j.eT)(c),e.abrupt("return",(0,j.Qm)(l,a,s));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createClassBreaksResponse",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var n,i,a,s,u,c,l,f,h,p,d,y,m;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.field,i=r.valueExpression,a=r.normalizationField,s=r.normalizationType,u=r.normalizationTotal,c=r.classificationMethod,l=r.standardDeviationInterval,f=r.minValue,h=r.maxValue,p=r.numClasses,d=r.scale,e.next=13,this._getDataValues(t,{field:n,valueExpression:i,normalizationField:a,normalizationType:s,normalizationTotal:u,scale:d});case 13:return y=e.sent,m=(0,j.G2)(y,{field:n,normalizationField:a,normalizationType:s,normalizationTotal:u,classificationMethod:c,standardDeviationInterval:l,minValue:f,maxValue:h,numClasses:p}),e.abrupt("return",(0,j.DL)(m,c));case 16:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createHistogramResponse",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var n,i,a,s,u,c,l,f,h,p,d,y;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.field,i=r.valueExpression,a=r.normalizationField,s=r.normalizationType,u=r.normalizationTotal,c=r.classificationMethod,l=r.standardDeviationInterval,f=r.minValue,h=r.maxValue,p=r.numBins,d=r.scale,e.next=13,this._getDataValues(t,{field:n,valueExpression:i,normalizationField:a,normalizationType:s,normalizationTotal:u,scale:d});case 13:return y=e.sent,e.abrupt("return",(0,j.oF)(y,{field:n,normalizationField:a,normalizationType:s,normalizationTotal:u,classificationMethod:c,standardDeviationInterval:l,minValue:f,maxValue:h,numBins:p}));case 15:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_sortFeatures",value:function(e,t,r){var n=this;if(e.length>1&&t&&t.length){var a,s=(0,i.Z)(t.reverse());try{var u=function(){var t=a.value.split(" "),i=t[0],s=n.fieldsIndex.get(i),u=t[1]&&"desc"===t[1].toLowerCase(),o=(0,j.Lq)(null==s?void 0:s.type,u);e.sort((function(e,t){var n=r(e,i,s),a=r(t,i,s);return o(n,a)}))};for(s.s();!(a=s.n()).done;)u()}catch(o){s.e(o)}finally{s.f()}}}},{key:"_createFeatureQueryResponse",value:function(e){var t=this,r=this.items,n=this.geometryType,i=this.hasM,a=this.hasZ,s=this.objectIdField,u=this.spatialReference,o=e.outFields,c=e.outSR,l=e.quantizationParameters,f=e.resultRecordCount,h=e.resultOffset,p=e.returnZ,d=e.returnM,y=null!=f&&r.length>(h||0)+f,m=o&&(o.includes("*")?(0,b.Z)(this.fieldsIndex.fields):o.map((function(e){return t.fieldsIndex.get(e)})));return{exceededTransferLimit:y,features:this._createFeatures(e,r),fields:m,geometryType:n,hasM:i&&d,hasZ:a&&p,objectIdFieldName:s,spatialReference:(0,W.S2)(c||u),transform:l&&(0,D.vY)(l)||null}}},{key:"_createFeatures",value:function(e,t){var r=new B(e,this.featureAdapter,this.fieldsIndex),n=this.hasM,a=this.hasZ,s=e.orderByFields,u=e.quantizationParameters,o=e.returnGeometry,c=e.returnCentroid,l=e.maxAllowableOffset,f=e.resultOffset,h=e.resultRecordCount,p=e.returnZ,d=void 0!==p&&p,y=e.returnM,m=a&&d,v=n&&(void 0!==y&&y),x=[],g=0,S=(0,b.Z)(t);if(this._sortFeatures(S,s,(function(e,t,n){return r.getFieldValue(e,t,n)})),o||c){var _=(0,D.vY)(u);if(o&&!c){var k,w=(0,i.Z)(S);try{for(w.s();!(k=w.n()).done;){var F=k.value;x[g++]={attributes:r.getAttributes(F),geometry:(0,W.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(F),l,_,m,v)}}}catch(N){w.e(N)}finally{w.f()}}else if(!o&&c){var I,R=(0,i.Z)(S);try{for(R.s();!(I=R.n()).done;){var Z=I.value;x[g++]={attributes:r.getAttributes(Z),centroid:(0,W.EG)(this,this.featureAdapter.getCentroid(Z,this),_)}}}catch(N){R.e(N)}finally{R.f()}}else{var T,A=(0,i.Z)(S);try{for(A.s();!(T=A.n()).done;){var E=T.value;x[g++]={attributes:r.getAttributes(E),centroid:(0,W.EG)(this,this.featureAdapter.getCentroid(E,this),_),geometry:(0,W.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(E),l,_,m,v)}}}catch(N){A.e(N)}finally{A.f()}}}else{var Q,C=(0,i.Z)(S);try{for(C.s();!(Q=C.n()).done;){var V=Q.value,z=r.getAttributes(V);z&&(x[g++]={attributes:z})}}catch(N){C.e(N)}finally{C.f()}}var G=f||0;if(null!=h){var P=G+h;x=x.slice(G,Math.min(x.length,P))}return x}},{key:"_createExceedsLimitQueryResponse",value:function(e){var t,r=!1,n=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,u=(0,i.Z)(e.outStatistics);try{for(u.s();!(t=u.n()).done;){var o=t.value;if("exceedslimit"===o.statisticType){n=null!=o.maxPointCount?o.maxPointCount:Number.POSITIVE_INFINITY,a=null!=o.maxRecordCount?o.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=o.maxVertexCount?o.maxVertexCount:Number.POSITIVE_INFINITY;break}}}catch(f){u.e(f)}finally{u.f()}if("esriGeometryPoint"===this.geometryType)r=this.items.length>n;else if(this.items.length>a)r=!0;else{var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter;r=this.items.reduce((function(e,t){var r=l.getGeometry(t);return e+(o(r)&&r.coords.length||0)}),0)/c>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(r)}}]}}},{key:"_createStatisticsQueryResponse",value:function(){var e=(0,a.Z)(o.mark((function e(t){var r,n,a,s,u,c,l,f,h,p,d,y,m,v,x,g,b,S,_,k,w,F,I,R,Z,T,A,E,Q,C,V,z,G,P,N,M,O,D,q=this;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={attributes:{}},n=[],a=new Map,s=new Map,u=new Map,c=new Map,l=new B(t,this.featureAdapter,this.fieldsIndex),f=t.outStatistics,h=t.groupByFieldsForStatistics,p=t.having,d=t.orderByFields,y=h&&h.length,v=(m=!!y)&&h[0],x=m&&!this.fieldsIndex.get(v),g=(0,i.Z)(f),e.prev=2,g.s();case 4:if((b=g.n()).done){e.next=34;break}if(S=b.value,_=S.outStatisticFieldName,k=S.statisticType,w=S,F="exceedslimit"!==k?S.onStatisticField:void 0,I="percentile_disc"===k||"percentile_cont"===k,R="EnvelopeAggregate"===k||"CentroidAggregate"===k||"ConvexHullAggregate"===k,Z=m&&1===y&&(F===v||x)&&"count"===k,!m){e.next=19;break}if(!u.has(F)){T=[],A=(0,i.Z)(h);try{for(A.s();!(E=A.n()).done;)Q=E.value,C=this._getAttributeValues(l,Q,a),T.push(C)}catch(j){A.e(j)}finally{A.f()}u.set(F,this._calculateUniqueValues(T,l.returnDistinctValues))}V=u.get(F),z=o.mark((function e(t){var r,n,i,s,u,f,d,y,m,v,x,g,b;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=V[t],n=r.count,i=r.data,s=r.items,u=r.itemPositions,f=i.join(","),p&&!l.validateItems(s,p)){e.next=17;break}if(d=c.get(f)||{attributes:{}},!R){e.next=13;break}return d.aggregateGeometries||(d.aggregateGeometries={}),e.next=7,q._getAggregateGeometry(w,s);case 7:y=e.sent,m=y.aggregateGeometries,v=y.outStatisticFieldName,d.aggregateGeometries[v]=m,e.next=16;break;case 13:x=null,Z?x=n:(g=q._getAttributeValues(l,F,a),b=u.map((function(e){return g[e]})),x=I&&"statisticParameters"in w?q._getPercentileValue(w,b):q._getStatisticValue(w,b,null,l.returnDistinctValues)),d.attributes[_]=x;case 16:h.forEach((function(e,t){return d.attributes[q.fieldsIndex.get(e)?e:"EXPR_".concat(t+1)]=i[t]})),c.set(f,d);case 17:case"end":return e.stop()}}),e)})),e.t0=o.keys(V);case 12:if((e.t1=e.t0()).done){e.next=17;break}return G=e.t1.value,e.delegateYield(z(G),"t2",15);case 15:e.next=12;break;case 17:e.next=31;break;case 19:if(!R){e.next=29;break}return r.aggregateGeometries||(r.aggregateGeometries={}),e.next=23,this._getAggregateGeometry(w,this.items);case 23:P=e.sent,N=P.aggregateGeometries,M=P.outStatisticFieldName,r.aggregateGeometries[M]=N,e.next=31;break;case 29:O=this._getAttributeValues(l,F,a),r.attributes[_]=I&&"statisticParameters"in w?this._getPercentileValue(w,O):this._getStatisticValue(w,O,s,l.returnDistinctValues);case 31:n.push({name:_,alias:_,type:"esriFieldTypeDouble"});case 32:e.next=4;break;case 34:e.next=39;break;case 36:e.prev=36,e.t3=e.catch(2),g.e(e.t3);case 39:return e.prev=39,g.f(),e.finish(39);case 42:return D=m?Array.from(c.values()):[r],e.abrupt("return",(this._sortFeatures(D,d,(function(e,t){return e.attributes[t]})),{fields:n,features:D}));case 44:case"end":return e.stop()}}),e,this,[[2,36,39,42]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_getAggregateGeometry",value:function(){var e=(0,a.Z)(o.mark((function e(t,i){var a,s,u,c,l,f,h,p,d,y,m,v,x;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9058),r.e(3645)]).then(r.bind(r,50309));case 2:return a=e.sent,s=t.statisticType,u=t.outStatisticFieldName,c=this.featureAdapter,l=this.spatialReference,f=this.geometryType,h=this.hasZ,p=this.hasM,d=i.map((function(e){return(0,W.Op)(f,h,p,c.getGeometry(e))})),y=a.convexHull(l,d,!0)[0],m={aggregateGeometries:null,outStatisticFieldName:null},"EnvelopeAggregate"===s?(v=y?(0,O._w)(y):(0,O.aO)(a.union(l,d)),m.aggregateGeometries=(0,n.Z)((0,n.Z)({},v),{},{spatialReference:l}),m.outStatisticFieldName=u||"extent"):"CentroidAggregate"===s?(x=y?(0,M.tO)(y):(0,M.$G)((0,O.aO)(a.union(l,d))),m.aggregateGeometries={x:x[0],y:x[1],spatialReference:l},m.outStatisticFieldName=u||"centroid"):"ConvexHullAggregate"===s&&(m.aggregateGeometries=y,m.outStatisticFieldName=u||"convexHull"),e.abrupt("return",m);case 15:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getStatisticValue",value:function(e,t,r,n){var i,a=e.onStatisticField,s=e.statisticType;return i=null!=r&&r.has(a)?r.get(a):(0,Y.qN)(this.fieldsIndex.get(a))?(0,j.H0)({values:t,returnDistinct:n}):(0,j.i5)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),r&&r.set(a,i),i["var"===s?"variance":s]}},{key:"_getPercentileValue",value:function(e,t){var r=e.onStatisticField,n=e.statisticParameters,i=e.statisticType,a=n.value,s=n.orderBy,u=this.fieldsIndex.get(r),o={value:a,orderBy:s,fieldType:null==u?void 0:u.type,isDiscrete:"percentile_disc"===i};return(0,j.XL)(t,o)}},{key:"_getAttributeValues",value:function(e,t,r){if(r.has(t))return r.get(t);var n=this.fieldsIndex.get(t),i=this.items.map((function(r){return e.getFieldValue(r,t,n)}));return r.set(t,i),i}},{key:"_getAttributeNormalizedValues",value:function(e,t){var r=this;return this.items.map((function(n){return e.getNormalizedValue(n,{field:t.field,fieldInfo:r.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:r.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})}))}},{key:"_getAttributeExpressionValues",value:function(){var e=(0,a.Z)(o.mark((function e(t,r,n){var i,a,s,u;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,L.LC)();case 2:return i=e.sent,a=i.arcadeUtils,s=a.createFunction(r),u=n&&a.getViewInfo(n),e.abrupt("return",this.items.map((function(e){return t.getExpressionValue(e,{compiledFunc:s,viewInfo:u},a)})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_calculateUniqueValues",value:function(e,t){for(var r={},n=this.items,a=n.length,s=0;s<a;s++){var u,o=n[s],c=[],l=(0,i.Z)(e);try{for(l.s();!(u=l.n()).done;){var f=u.value;c.push(f[s])}}catch(p){l.e(p)}finally{l.f()}var h=c.join(",");t?null==r[h]&&(r[h]={count:1,data:c,items:[o],itemPositions:[s]}):null==r[h]?r[h]={count:1,data:c,items:[o],itemPositions:[s]}:(r[h].count++,r[h].items.push(o),r[h].itemPositions.push(s))}return r}},{key:"_getDataValues",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var n,i,a,s,u,c,l,f;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new B(t,this.featureAdapter,this.fieldsIndex),i=r.valueExpression,a=r.field,s=r.normalizationField,u=r.normalizationType,c=r.normalizationTotal,l=r.scale,f=i?{viewingMode:"map",scale:l,spatialReference:t.outSR||this.spatialReference}:null,e.abrupt("return",i?this._getAttributeExpressionValues(n,i,f):this._getAttributeNormalizedValues(n,{field:a,normalizationField:s,normalizationType:u,normalizationTotal:c}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}();function X(e,t,r,n,i,a){var s=i-r,u=a-n,o=s*s+u*u,c=(e-r)*s+(t-n)*u,l=Math.min(1,Math.max(0,c/o));return{x:r+s*l,y:n+u*l}}(G=z||(z={}))[G.NONE=0]="NONE",G[G.EDGE=1]="EDGE",G[G.VERTEX=2]="VERTEX";var J=r(77095),$=r(52410),K=r(40993);function ee(e){return e.every((function(e){return"exceedslimit"!==e.statisticType}))}var te="feature-store:unsupported-query",re=new Set,ne=new h.WJ(2e6),ie=0,ae=function(){function e(t){var r=this;(0,u.Z)(this,e),this.capabilities={query:N.g},this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.definitionExpression=t.definitionExpression,this.featureStore=t.featureStore,this.aggregateAdapter=t.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(function(){return r.clearCache()})),this.timeInfo=t.timeInfo,t.cacheSpatialQueries&&(this._geometryQueryCache=new h.Xq(ie+++"$$",ne)),this.fieldsIndex=new $.Z(t.fields),t.scheduler&&t.priority&&(this._frameTask=t.scheduler.registerTask(t.priority))}return(0,s.Z)(e,[{key:"destroy",value:function(){this._frameTask=(0,f.hw)(this._frameTask),this.clearCache(),(0,f.SC)(this._geometryQueryCache),this._changeHandle=(0,f.hw)(this._changeHandle),(0,f.SC)(this.fieldsIndex)}},{key:"featureAdapter",get:function(){return this.featureStore.featureAdapter}},{key:"fullExtent",get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:(0,W.S2)(this.spatialReference)}:null}},{key:"timeExtent",get:function(){return this.timeInfo?(this._timeExtent||(this._timeExtent=(0,U.R)(this.timeInfo,this.featureStore)),this._timeExtent):null}},{key:"clearCache",value:function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}},{key:"executeQuery",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a=this,s=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,i=(0,l.d9)(t),e.prev=3,e.next=6,this._schedule((function(){return(0,W.Up)(i,a.definitionExpression,a.spatialReference)}),r);case 6:return i=e.sent,e.next=9,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 9:return i=e.sent,e.next=12,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 12:return n=e.sent,e.next=15,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 15:return n=e.sent,e.next=18,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 18:return n=e.sent,e.next=21,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 21:return n=e.sent,e.next=24,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 24:n=e.sent,e.next=32;break;case 27:if(e.prev=27,e.t0=e.catch(3),e.t0===W.vF){e.next=31;break}throw e.t0;case 31:n=new H([],null,this);case 32:return e.abrupt("return",n.createQueryResponse(i));case 33:case"end":return e.stop()}}),e,this,[[3,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForCount",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a=this,s=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,(n=(0,l.d9)(t)).returnGeometry=!1,n.returnCentroid=!1,n.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return(0,W.Up)(n,a.definitionExpression,a.spatialReference)}),r);case 7:return n=e.sent,e.next=10,this._reschedule((function(){return a._checkQuerySupport(n)}),r);case 10:return n=e.sent,e.next=13,this._reschedule((function(){return a._executeGeometryQuery(n,r)}),r);case 13:return i=e.sent,e.next=16,this._reschedule((function(){return i.executeAggregateIdsQuery(n)}),r);case 16:return i=e.sent,e.next=19,this._reschedule((function(){return i.executeObjectIdsQuery(n)}),r);case 19:return i=e.sent,e.next=22,this._reschedule((function(){return i.executeTimeQuery(n)}),r);case 22:return i=e.sent,e.next=25,this._reschedule((function(){return i.executeAttributesQuery(n)}),r);case 25:return i=e.sent,e.abrupt("return",i.createQueryResponseForCount(n));case 29:if(e.prev=29,e.t0=e.catch(4),e.t0===W.vF){e.next=33;break}throw e.t0;case 33:return e.abrupt("return",0);case 34:case"end":return e.stop()}}),e,this,[[4,29]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForExtent",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a,s,u,c,f,h,y,m=this,v=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.length>0&&void 0!==v[0]?v[0]:{},r=v.length>1?v[1]:void 0,i=(0,l.d9)(t),a=i.outSR,e.prev=4,e.next=7,this._schedule((function(){return(0,W.Up)(i,m.definitionExpression,m.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return m._checkQuerySupport(i)}),r);case 10:return(i=e.sent).returnGeometry=!0,i.returnCentroid=!1,i.outSR=null,e.next=16,this._reschedule((function(){return m._executeGeometryQuery(i,r)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 25:return n=e.sent,e.next=28,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 28:if(n=e.sent,s=n.size){e.next=32;break}return e.abrupt("return",{count:s,extent:null});case 32:return(0,d.t8)(ue,d.Gv),this.featureStore.forEachBounds(n.items,(function(e){return(0,d.TC)(ue,e)}),se),u={xmin:ue[0],ymin:ue[1],xmax:ue[3],ymax:ue[4],spatialReference:(0,W.S2)(this.spatialReference)},this.hasZ&&isFinite(ue[2])&&isFinite(ue[5])&&(u.zmin=ue[2],u.zmax=ue[5]),(c=(0,P.iV)(u,n.spatialReference,a)).spatialReference=(0,W.S2)(a||this.spatialReference),c.xmax-c.xmin==0&&(f=(0,p.c9)(c.spatialReference),c.xmin-=f,c.xmax+=f),c.ymax-c.ymin==0&&(h=(0,p.c9)(c.spatialReference),c.ymin-=h,c.ymax+=h),this.hasZ&&null!=c.zmin&&null!=c.zmax&&c.zmax-c.zmin==0&&(y=(0,p.c9)(c.spatialReference),c.zmin-=y,c.zmax+=y),e.abrupt("return",{count:s,extent:c});case 42:if(e.prev=42,e.t0=e.catch(4),e.t0!==W.vF){e.next=46;break}return e.abrupt("return",{count:0,extent:null});case 46:throw e.t0;case 47:case"end":return e.stop()}}),e,this,[[4,42]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForIds",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1?n[1]:void 0,e.abrupt("return",this.executeQueryForIdSet(t,r).then((function(e){return Array.from(e)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForIdSet",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,a,s,u,c=this,f=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:{},r=f.length>1?f[1]:void 0,(a=(0,l.d9)(t)).returnGeometry=!1,a.returnCentroid=!1,a.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return(0,W.Up)(a,c.definitionExpression,c.spatialReference)}),r);case 7:return a=e.sent,e.next=10,this._reschedule((function(){return c._checkQuerySupport(a)}),r);case 10:return a=e.sent,e.next=13,this._reschedule((function(){return c._executeGeometryQuery(a,r)}),r);case 13:return n=e.sent,e.next=16,this._reschedule((function(){return n.executeAggregateIdsQuery(a)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeObjectIdsQuery(a)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeTimeQuery(a)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeAttributesQuery(a)}),r);case 25:return n=e.sent,s=n.items,u=new Set,e.next=29,this._reschedule((function(){var e,t=(0,i.Z)(s);try{for(t.s();!(e=t.n()).done;){var r=e.value;u.add(n.featureAdapter.getObjectId(r))}}catch(a){t.e(a)}finally{t.f()}}),r);case 29:return e.abrupt("return",u);case 32:if(e.prev=32,e.t0=e.catch(4),e.t0!==W.vF){e.next=36;break}return e.abrupt("return",new Set);case 36:throw e.t0;case 37:case"end":return e.stop()}}),e,this,[[4,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForSnapping",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var i,a,s,u,c,l,h,p,d,y,m,b,S,_,k=this;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.point,a=t.distance,t.types!==z.NONE){e.next=3;break}return e.abrupt("return",{candidates:[]});case 3:return e.next=5,this._reschedule((function(){return k._checkQuerySupport(t.query)}),r);case 5:if(s=e.sent,u=!(0,g.fS)(i.spatialReference,this.spatialReference),e.t0=u,!e.t0){e.next=11;break}return e.next=11,(0,P._W)(i.spatialReference,this.spatialReference);case 11:if(c="number"==typeof a?a:a.x,l="number"==typeof a?a:a.y,h={xmin:i.x-c,xmax:i.x+c,ymin:i.y-l,ymax:i.y+l,spatialReference:i.spatialReference},p=u?(0,P.iV)(h,this.spatialReference):h){e.next=14;break}return e.abrupt("return",{candidates:[]});case 14:return e.next=16,(0,x.aX)((0,v.im)(i),null,{signal:r});case 16:return d=e.sent[0],e.next=19,(0,x.aX)((0,v.im)(p),null,{signal:r});case 19:if(y=e.sent[0],!(0,f.Wi)(d)&&!(0,f.Wi)(y)){e.next=22;break}return e.abrupt("return",{candidates:[]});case 22:return m=new H(this._searchFeatures(this._getQueryBBoxes(y.toJSON())),null,this),e.next=25,this._reschedule((function(){return m.executeObjectIdsQuery(s)}),r);case 25:return m=e.sent,e.next=28,this._reschedule((function(){return m.executeTimeQuery(s)}),r);case 28:return m=e.sent,e.next=31,this._reschedule((function(){return m.executeAttributesQuery(s)}),r);case 31:return m=e.sent,b=d.toJSON(),S=u?(0,P.iV)(b,this.spatialReference):b,_=u?Math.max(p.xmax-p.xmin,p.ymax-p.ymin)/2:a,e.abrupt("return",m.createSnappingResponse((0,n.Z)((0,n.Z)({},t),{},{point:S,distance:_}),i.spatialReference));case 34:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQueryForLatestObservations",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a=this,s=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,this.timeInfo&&this.timeInfo.trackIdField){e.next=4;break}throw new c.Z(te,"Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:this.timeInfo});case 4:return i=(0,l.d9)(t),e.prev=5,e.next=8,this._schedule((function(){return(0,W.Up)(i,a.definitionExpression,a.spatialReference)}),r);case 8:return i=e.sent,e.next=11,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 11:return i=e.sent,e.next=14,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 14:return n=e.sent,e.next=17,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 17:return n=e.sent,e.next=20,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 20:return n=e.sent,e.next=23,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 23:return n=e.sent,e.next=26,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 26:return n=e.sent,e.next=29,this._reschedule((function(){return n.filterLatest()}),r);case 29:n=e.sent,e.next=37;break;case 32:if(e.prev=32,e.t0=e.catch(5),e.t0===W.vF){e.next=36;break}throw e.t0;case 36:n=new H([],null,this);case 37:return e.abrupt("return",n.createQueryResponse(i));case 38:case"end":return e.stop()}}),e,this,[[5,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForSummaryStatistics",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a,s,u=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,n=u.length>2?u[2]:void 0,i=r.field,a=r.normalizationField,s=r.valueExpression,e.next=6,this._getQueryEngineResultForStats(t,{field:i,normalizationField:a,valueExpression:s},n);case 6:return e.abrupt("return",e.sent.createSummaryStatisticsResponse(t,r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForUniqueValues",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a,s=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,n=s.length>2?s[2]:void 0,i=r.field,a=r.valueExpression,e.next=6,this._getQueryEngineResultForStats(t,{field:i,valueExpression:a},n);case 6:return e.abrupt("return",e.sent.createUniqueValuesResponse(t,r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForClassBreaks",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a,s,u=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,n=u.length>2?u[2]:void 0,i=r.field,a=r.normalizationField,s=r.valueExpression,e.next=6,this._getQueryEngineResultForStats(t,{field:i,normalizationField:a,valueExpression:s},n);case 6:return e.abrupt("return",e.sent.createClassBreaksResponse(t,r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForHistogram",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a,s,u=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,n=u.length>2?u[2]:void 0,i=r.field,a=r.normalizationField,s=r.valueExpression,e.next=6,this._getQueryEngineResultForStats(t,{field:i,normalizationField:a,valueExpression:s},n);case 6:return e.abrupt("return",e.sent.createHistogramResponse(t,r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_schedule",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.pC)(this._frameTask)?this._frameTask.schedule(t,r):t(K.G5));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_reschedule",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.pC)(this._frameTask)?this._frameTask.reschedule(t,r):t(K.G5));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getAll",value:function(){if(!this._allItems){var e=[];this.featureStore.forEach((function(t){return e.push(t)})),this._allItems=new H(e,null,this)}return this._allItems}},{key:"_executeGeometryQuery",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var n,s,u,c,l,h,p,d,y,m,v,x,b,S,_,k,w,F,I,R,Z,T,A,E,Q,C=this;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.geometry,s=t.outSR,u=t.spatialRel,c=t.returnGeometry,l=t.returnCentroid,h=this.featureStore.featureSpatialReference,p=n&&h&&h!==n.spatialReference?(0,P.iV)(n,h):n,d=c||l,y=(0,g.JY)(s)&&!(0,g.fS)(this.spatialReference,s),!(m=this._geometryQueryCache?y&&d?JSON.stringify({originalFilterGeometry:n,spatialRelationship:u,outSpatialReference:s}):JSON.stringify({originalFilterGeometry:n,spatialRelationship:u}):null)){e.next=5;break}if(v=this._geometryQueryCache.get(m),(0,f.o8)(v)){e.next=5;break}return e.abrupt("return",v);case 5:if(x=function(){var e=(0,a.Z)(o.mark((function e(t){var r;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y||!d){e.next=5;break}return e.next=3,t.project(s);case 3:return r=e.sent,e.abrupt("return",(m&&C._geometryQueryCache.put(m,r,r.size||1),r));case 5:return e.abrupt("return",(m&&C._geometryQueryCache.put(m,t,t.size||1),t));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p){e.next=8;break}return e.abrupt("return",x(this._getAll()));case 8:if(b=this.featureAdapter,"esriSpatialRelDisjoint"!==u){e.next=22;break}if((S=this._searchFeatures(this._getQueryBBoxes(n))).length){e.next=13;break}return e.abrupt("return",x(this._getAll()));case 13:w=new Set,F=(0,i.Z)(S);try{for(F.s();!(I=F.n()).done;)R=I.value,w.add(b.getObjectId(R))}catch(V){F.e(V)}finally{F.f()}return e.next=18,this._reschedule((function(){var e=0;_=new Array(w.size),C.featureStore.forEach((function(t){return _[e++]=t})),k=w}),r);case 18:return e.next=20,this._reschedule((0,a.Z)(o.mark((function e(){var t,i;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.cW)(u,p,C.geometryType,C.hasZ,C.hasM);case 2:return t=e.sent,i=function(e){return!k.has(b.getObjectId(e))||t(b.getGeometry(e))},e.t0=H,e.next=7,C._runSpatialFilter(_,i,r);case 7:return e.t1=e.sent,e.t2=n,e.t3=C,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3));case 11:case"end":return e.stop()}}),e)}))),r);case 20:return Z=e.sent,e.abrupt("return",x(Z));case 22:if((T=this._searchFeatures(this._getQueryBBoxes(n))).length){e.next=26;break}return A=new H([],n,this),e.abrupt("return",(m&&this._geometryQueryCache.put(m,A,A.size||1),A));case 26:if(!this._canExecuteSoloPass(p,t)){e.next=28;break}return e.abrupt("return",x(new H(T,n,this)));case 28:return e.next=30,(0,J.cW)(u,p,this.geometryType,this.hasZ,this.hasM);case 30:return E=e.sent,e.next=33,this._runSpatialFilter(T,(function(e){return E(b.getGeometry(e))}),r);case 33:return Q=e.sent,e.abrupt("return",x(new H(Q,n,this)));case 35:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_runSpatialFilter",value:function(){var e=(0,a.Z)(o.mark((function e(t,r,n){var i,s,u,c=this;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",t);case 2:if(!(0,f.Wi)(this._frameTask)){e.next=4;break}return e.abrupt("return",t.filter((function(e){return r(e)})));case 4:return i=0,s=new Array,u=function(){var e=(0,a.Z)(o.mark((function e(a){var l;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<t.length)){e.next=9;break}if(l=t[i++],r(l)&&(s.push(l),a.madeProgress()),e.t0=a.done,!e.t0){e.next=7;break}return e.next=7,c._reschedule((function(e){return u(e)}),n);case 7:e.next=0;break;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.abrupt("return",this._reschedule((function(e){return u(e)}),n).then((function(){return s})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_canExecuteSoloPass",value:function(e,t){var r=this.geometryType,n=t.spatialRel;return(0,J.hN)(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))}},{key:"_getQueryBBoxes",value:function(e){if((0,J.hN)(e)){if((0,v.YX)(e))return[(0,y.al)(e.xmin,e.ymin,e.xmax,e.ymax)];if((0,v.oU)(e))return e.rings.map((function(e){return(0,y.al)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[(0,m.$P)((0,y.Ue)(),e)]}},{key:"_searchFeatures",value:function(e){var t,r=(0,i.Z)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.featureStore.forEachInBounds(n,(function(e){re.add(e)}))}}catch(u){r.e(u)}finally{r.f()}var a=new Array(re.size),s=0;return re.forEach((function(e){return a[s++]=e})),re.clear(),a}},{key:"_checkStatisticsSupport",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)){e.next=2;break}throw new c.Z(te,"Unsupported query options",{query:t});case 2:return e.abrupt("return",Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsParamsSupport(r),(0,J.P0)(t,this.geometryType,this.spatialReference),(0,P._W)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_checkStatisticsParamsSupport",value:function(){var e=(0,a.Z)(o.mark((function e(t){var r,n,i;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],!t.valueExpression){e.next=7;break}return e.next=4,(0,L.LC)();case 4:n=e.sent,i=n.arcadeUtils,r=i.extractFieldNames(t.valueExpression);case 7:if(t.field&&r.push(t.field),t.normalizationField&&r.push(t.normalizationField),r.length){e.next=9;break}throw new c.Z(te,"params should have at least a field or valueExpression",{params:t});case 9:E(this.fieldsIndex,r,"params contains missing fields");case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_checkQuerySupport",value:function(){var e=(0,a.Z)(o.mark((function e(t){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)){e.next=2;break}throw new c.Z(te,"Unsupported query options",{query:t});case 2:return e.abrupt("return",Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),(0,J.P0)(t,this.geometryType,this.spatialReference),(0,P._W)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_checkAttributesQuerySupport",value:function(e){var t=e.outFields,r=e.orderByFields,n=e.returnDistinctValues,i=e.outStatistics,a=i?i.map((function(e){return e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()})).filter(Boolean):[];if(r&&r.length>0){var s=" asc",u=" desc",o=r.map((function(e){var t=e.toLowerCase();return t.indexOf(s)>-1?t.split(s)[0]:t.indexOf(u)>-1?t.split(u)[0]:e})).filter((function(e){return-1===a.indexOf(e)}));E(this.fieldsIndex,o,"orderByFields contains missing fields")}if(t&&t.length>0)E(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new c.Z(te,"outFields should be specified for returnDistinctValues",{query:e});Z(this.fieldsIndex,e.where)}},{key:"_checkStatisticsQuerySupport",value:function(){var e=(0,a.Z)(o.mark((function e(t){var r,n,a,s,u,l,f,h,p,d,y;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.outStatistics,n=t.groupByFieldsForStatistics,a=t.having,s=n&&n.length,u=r&&r.length,!a){e.next=5;break}if(s&&u){e.next=4;break}throw new c.Z(te,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});case 4:T(this.fieldsIndex,a,r);case 5:if(!u){e.next=34;break}if(ee(r)){e.next=8;break}return e.abrupt("return");case 8:l=r.map((function(e){return e.onStatisticField})).filter(Boolean),E(this.fieldsIndex,l,"onStatisticFields contains missing fields"),s&&E(this.fieldsIndex,n,"groupByFieldsForStatistics contains missing fields"),f=(0,i.Z)(r),e.prev=11,f.s();case 13:if((h=f.n()).done){e.next=26;break}if(p=h.value,d=p.onStatisticField,"percentile_disc"!==(y=p.statisticType)&&"percentile_cont"!==y||!("statisticParameters"in p)){e.next=22;break}if(p.statisticParameters){e.next=20;break}throw new c.Z(te,"statisticParamters should be set for percentile type",{definition:p,query:t});case 20:e.next=24;break;case 22:if("count"===y||!d||!V(d,this.fieldsIndex)){e.next=24;break}throw new c.Z(te,"outStatistics contains non-numeric fields",{definition:p,query:t});case 24:e.next=13;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(11),f.e(e.t0);case 31:return e.prev=31,f.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[11,28,31,34]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_getQueryEngineResultForStats",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a=this,s=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,n=s.length>2?s[2]:void 0,t=(0,l.d9)(t),e.prev=4,e.next=7,this._schedule((function(){return(0,W.Up)(t,a.definitionExpression,a.spatialReference)}),n);case 7:return t=e.sent,e.next=10,this._reschedule((function(){return a._checkStatisticsSupport(t,r)}),n);case 10:return t=e.sent,e.next=13,this._reschedule((function(){return a._executeGeometryQuery(t,n)}),n);case 13:return i=e.sent,e.next=16,this._reschedule((function(){return i.executeAggregateIdsQuery(t)}),n);case 16:return i=e.sent,e.next=19,this._reschedule((function(){return i.executeObjectIdsQuery(t)}),n);case 19:return i=e.sent,e.next=22,this._reschedule((function(){return i.executeTimeQuery(t)}),n);case 22:return i=e.sent,e.next=25,this._reschedule((function(){return i.executeAttributesQuery(t)}),n);case 25:i=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(4),e.t0===W.vF){e.next=32;break}throw e.t0;case 32:i=new H([],null,this);case 33:return e.abrupt("return",i);case 34:case"end":return e.stop()}}),e,this,[[4,28]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),se=(0,d.Ue)(),ue=(0,d.Ue)()},60480:function(e,t,r){r.d(t,{g:function(){return n}});var n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},77095:function(e,t,r){r.d(t,{hN:function(){return A},P0:function(){return Z},cW:function(){return R}});var n=r(37762),i=r(15861),a=r(87757),s=r(10064),u=r(34066),o=r(66504);var c=r(77981),l=r(92975);function f(e,t){return e?t?4:3:t?3:2}function h(e,t,r,n,i,a){var s=f(i,a),u=n.coords,o=n.lengths;if(!o)return!1;for(var c=0,l=0;c<o.length;c++,l+=s)if(!p(e,t,r,u[l],u[l+1]))return!1;return!0}function p(e,t,r,i,a){if(!e)return!1;var s,u=f(t,r),o=e.coords,c=e.lengths,l=!1,h=0,p=(0,n.Z)(c);try{for(p.s();!(s=p.n()).done;){var y=s.value;l=d(l,o,u,h,y,i,a),h+=y*u}}catch(m){p.e(m)}finally{p.f()}return l}function d(e,t,r,n,i,a,s){for(var u=e,o=n,c=n,l=n+i*r;c<l;c+=r){(o=c+r)===l&&(o=n);var f=t[c],h=t[c+1],p=t[o],d=t[o+1];(h<s&&d>=s||d<s&&h>=s)&&f+(s-h)/(d-h)*(p-f)<a&&(u=!u)}return u}var y=r(83406),m=r(80457),v=r(19995),x=r(31904),g="feature-store:unsupported-query",b={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},S={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},_={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},k={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function w(e){return!0===S[e]}function F(e){return!0===_[(0,c.Ji)(e)]}function I(e){return!0===k[e]}function R(e,t,n,i,a){if((0,c.oU)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var s=(0,y.Uy)(new m.Z,t,!1,!1);return Promise.resolve((function(e){return function(e,t,r,n){return p(e,t,r,n.coords[0],n.coords[1])}(s,!1,!1,e)}))}if((0,c.oU)(t)&&"esriGeometryMultipoint"===n){var l=(0,y.Uy)(new m.Z,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve((function(e){return h(l,!1,!1,e,i,a)}))}if((0,c.YX)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve((function(e){return(0,u.aV)(t,(0,x.Op)(n,i,a,e))}));if((0,c.YX)(t)&&"esriGeometryMultipoint"===n&&"esriSpatialRelContains"===e)return Promise.resolve((function(e){return(0,u.lQ)(t,(0,x.Op)(n,i,a,e))}));if((0,c.YX)(t)&&"esriSpatialRelIntersects"===e){var f=function(e){return"mesh"===e?o.h_:(0,o.IY)(e)}(n);return Promise.resolve((function(e){return f(t,(0,x.Op)(n,i,a,e))}))}return Promise.all([r.e(9058),r.e(3645)]).then(r.bind(r,50309)).then((function(r){var s=r[b[e]].bind(null,t.spatialReference,t);return function(e){return s((0,x.Op)(n,i,a,e))}}))}function Z(e,t,r){return T.apply(this,arguments)}function T(){return T=(0,i.Z)(a.mark((function e(t,r,n){var i,u;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.spatialRel,!(u=t.geometry)){e.next=11;break}if(w(i)){e.next=4;break}throw new s.Z(g,"Unsupported query spatial relationship",{query:t});case 4:if(!(0,l.JY)(u.spatialReference)||!(0,l.JY)(n)){e.next=11;break}if(F(u)){e.next=7;break}throw new s.Z(g,"Unsupported query geometry type",{query:t});case 7:if(I(r)){e.next=9;break}throw new s.Z(g,"Unsupported layer geometry type",{query:t});case 9:if(!t.outSR){e.next=11;break}return e.abrupt("return",(0,v._W)(t.geometry&&t.geometry.spatialReference,t.outSR));case 11:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}function A(e){if((0,c.YX)(e))return!0;if((0,c.oU)(e)){var t,r=(0,n.Z)(e.rings);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(5!==i.length)return!1;if(i[0][0]!==i[1][0]||i[0][0]!==i[4][0]||i[2][0]!==i[3][0]||i[0][1]!==i[3][1]||i[0][1]!==i[4][1]||i[1][1]!==i[2][1])return!1}}catch(a){r.e(a)}finally{r.f()}return!0}return!1}},20311:function(e,t,r){function n(e,t){if(!e)return null;var r=t.featureAdapter,n=e.startTimeField,i=e.endTimeField,a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;if(n&&i)t.forEach((function(e){var t=r.getAttribute(e,n),u=r.getAttribute(e,i);null==t||isNaN(t)||(a=Math.min(a,t)),null==u||isNaN(u)||(s=Math.max(s,u))}));else{var u=n||i;t.forEach((function(e){var t=r.getAttribute(e,u);null==t||isNaN(t)||(a=Math.min(a,t),s=Math.max(s,t))}))}return{start:a,end:s}}function i(e,t,r){if(!t||!e)return null;var n=e.startTimeField,i=e.endTimeField;if(!n&&!i)return null;var a=t.start,s=t.end;return null===a&&null===s?null:void 0===a&&void 0===s?function(){return!1}:n&&i?function(e,t,r,n,i){return null!=n&&null!=i?function(a){var s=e.getAttribute(a,t),u=e.getAttribute(a,r);return(null==s||s<=i)&&(null==u||u>=n)}:null!=n?function(t){var i=e.getAttribute(t,r);return null==i||i>=n}:null!=i?function(r){var n=e.getAttribute(r,t);return null==n||n<=i}:void 0}(r,n,i,a,s):function(e,t,r,n){return null!=r&&null!=n&&r===n?function(n){return e.getAttribute(n,t)===r}:null!=r&&null!=n?function(i){var a=e.getAttribute(i,t);return a>=r&&a<=n}:null!=r?function(n){return e.getAttribute(n,t)>=r}:null!=n?function(r){return e.getAttribute(r,t)<=n}:void 0}(r,n||i,a,s)}r.d(t,{R:function(){return n},y:function(){return i}})},31904:function(e,t,r){r.d(t,{EG:function(){return S},Op:function(){return _},S2:function(){return E},Up:function(){return k},j6:function(){return F},vF:function(){return m}});var n=r(15861),i=r(87757),a=r(43404),s=r(92026),u=r(68860),o=r(94446),c=r(77981),l=r(50689),f=r(92975),h=r(83406),p=r(80457),d=r(19995),y=new a.X({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),m=Object.freeze({}),v=new p.Z,x=new p.Z,g=new p.Z,b={esriGeometryPoint:h.fQ,esriGeometryPolyline:h.J6,esriGeometryPolygon:h.eG,esriGeometryMultipoint:h.Iv};function S(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.hasZ,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.hasM;if((0,s.Wi)(t))return null;var a=e.hasZ&&n,u=e.hasM&&i;if(r){var o=(0,h.Nh)(g,t,e.hasZ,e.hasM,"esriGeometryPoint",r,n,i);return(0,h.fQ)(o,a,u)}return(0,h.fQ)(t,a,u)}function _(e,t,r,n,i,a){var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:r,c=t&&u,l=r&&o,f=(0,s.pC)(n)?"coords"in n?n:n.geometry:null;if((0,s.Wi)(f))return null;if(i){var p=(0,h.zj)(x,f,t,r,e,i,u,o);return a&&(p=(0,h.Nh)(g,p,c,l,e,a)),b[e](p,c,l)}if(a){var d=(0,h.Nh)(g,f,t,r,e,a,u,o);return b[e](d,c,l)}return(0,h.hY)(v,f,t,r,u,o),b[e](v,c,l)}function k(e,t,r){return w.apply(this,arguments)}function w(){return(w=(0,n.Z)(i.mark((function e(t,r,n){var a,s,u,o,c,l,f,h;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.outFields,s=t.orderByFields,u=t.groupByFieldsForStatistics,o=t.outStatistics,a)for(c=0;c<a.length;c++)a[c]=a[c].trim();if(s)for(l=0;l<s.length;l++)s[l]=s[l].trim();if(u)for(f=0;f<u.length;f++)u[f]=u[f].trim();if(o)for(h=0;h<o.length;h++)o[h].onStatisticField&&(o[h].onStatisticField=o[h].onStatisticField.trim());return e.abrupt("return",(t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),F(t,r,n)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,r){return I.apply(this,arguments)}function I(){return(I=(0,n.Z)(i.mark((function e(t,r,n){var a,u,f,h,p,y;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(a=t.where,t.where=a=a&&a.trim(),(!a||/^1 *= *1$/.test(a)||r&&r===a)&&(t.where=null),t.geometry){e.next=5;break}return e.abrupt("return",t);case 5:return e.next=7,R(t);case 7:return u=e.sent,t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel&&(f=t.geometry.spatialReference,(u=(0,o.aO)(u)).spatialReference=f),t.geometry=u,e.next=12,(0,d._W)(u.spatialReference,n);case 12:return e.next=14,(0,l.aX)((0,c.im)(u));case 14:if(h=e.sent[0],!(0,s.Wi)(h)){e.next=17;break}throw m;case 17:return p=h.toJSON(),e.next=20,(0,d.iV)(p,p.spatialReference,n);case 20:if(y=e.sent){e.next=23;break}throw m;case 23:return e.abrupt("return",(y.spatialReference=n,t.geometry=y,t));case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){return Z.apply(this,arguments)}function Z(){return(Z=(0,n.Z)(i.mark((function e(t){var r,n,a,s,o,c;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.geometry,n=t.distance,a=t.units,null!=n&&!("vertexAttributes"in r)){e.next=3;break}return e.abrupt("return",r);case 3:if(s=r.spatialReference,o=a?y.fromJSON(a):(0,u.qE)(s),!s||!(0,f.sT)(s)&&!(0,f.sS)(s)){e.next=9;break}e.t0=r,e.next=12;break;case 9:return e.next=11,(0,d._W)(s,f.Zn).then((function(){return(0,d.iV)(r,f.Zn)}));case 11:e.t0=e.sent;case 12:return c=e.t0,e.next=15,T();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t1)(c.spatialReference,c,n,o));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return A.apply(this,arguments)}function A(){return(A=(0,n.Z)(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9058),r.e(3645)]).then(r.bind(r,50309));case 2:return e.abrupt("return",e.sent.geodesicBuffer);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return e&&Q in e?JSON.parse(JSON.stringify(e,C)):e}var Q="_geVersion",C=function(e,t){return e!==Q?t:void 0}}}]);
//# sourceMappingURL=3706.293d8199.chunk.js.map